# chatchat

æ­¤é¡¹ç›®ä¸ºå‰åç«¯åˆ†ç¦»å¼€å‘||[åç«¯æ¥å£æ–‡æ¡£é“¾æ¥](https://console-docs.apipost.cn/preview/56cc7639487d33cb/20154c443f1b0168)

[![My Skills](https://skillicons.dev/icons?i=golang,docker,mysql,redis,postman,git)](https://skillicons.dev)



## ğŸ’¡  ç®€ä»‹

åŸºäº [gin ](https://github.com/gin-gonic/gin)æ¡†æ¶å®ç°çš„ä¸€ä¸ªç®€å•èŠå¤©å®¤åç«¯ï¼Œæ¨¡æ‹Ÿäº†ç¬¬ä¸‰æ–¹ç™»å½•



## ğŸš€ åŠŸèƒ½

### è®¤è¯ç³»ç»Ÿ

- ç¬¬ä¸‰æ–¹ç™»å½•é¢å‘ `oauth2 token`  (åŒ…å« `access token` å’Œ `refresh token`)
- ç™»å½•é¢å‘ `token`
- å¯¹ä»¤ç‰Œè¿›è¡Œè§£æè·å–è®¤è¯ä¿¡æ¯ä¸ç”¨æˆ·ä¿¡æ¯

### ç”¨æˆ·ç³»ç»Ÿ

- ç”¨æˆ·çš„ç™»å½•ä¸é‚®ç®±éªŒè¯ç æ³¨å†Œ
- ç¬¬ä¸‰æ–¹ç™»å½•&&ç»‘å®šé‚®ç®±
- ç”¨æˆ·æ”¹å,æ”¹å¤´åƒï¼Œæ”¹ç®€ä»‹ï¼Œæ”¹å¯†ç 
- è·å–ç”¨æˆ·ä¿¡æ¯

### å¥½å‹ç³»ç»Ÿ

- æ·»åŠ å¥½å‹
- åˆ é™¤å¥½å‹

### ç¾¤ç»„ç³»ç»Ÿ

- é€€å‡ºç¾¤ç»„
- åˆ é™¤ç¾¤ç»„ï¼ˆä»…ç¾¤ä¸»å¯æ“ä½œï¼‰
- è¸¢äººï¼ˆä»…ç¾¤ä¸»å¯æ“ä½œï¼‰
- å…³é”®è¯æ¨¡ç³ŠæŸ¥æ‰¾ç¾¤ç»„
- åˆ›å»ºç¾¤ç»„
- åŠ å…¥ç¾¤ç»„

### èŠå¤©ç³»ç»Ÿ

- å®æ—¶å‘é€æ¶ˆæ¯ï¼Œå®æ—¶æ¥æ”¶

- ç¦»çº¿çŠ¶æ€ä¸‹ä¹Ÿå¯æ¥æ”¶æ¶ˆæ¯ï¼Œä¸Šçº¿åå¯è·å–

- è·å–å†å²èŠå¤©è®°å½•ï¼ˆç¾¤ç»„å’Œå¥½å‹ï¼‰

  

  

## ğŸŒŸ äº®ç‚¹

### æŠ€æœ¯æ ˆ

- [gin](https://gin-gonic.com/zh-cn/docs/introduction/)

> Gin æ˜¯ä¸€ä¸ªç”¨ Go (Golang) ç¼–å†™çš„ Web æ¡†æ¶ã€‚
>

    æœ¬é¡¹ç›®åŠŸèƒ½ä¸æ˜¯å¾ˆç¹æ‚ï¼Œæ‰€ä»¥ç”¨ä¸ä¸Šå¾®æœåŠ¡ï¼Œæ‰€ä»¥é‡‡ç”¨äº†å†™å•ä½“æ¯”è¾ƒåˆé€‚çš„ginæ¡†æ¶

- [mysql](https://www.mysql.com/)

> ä¸€ä¸ªå…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œç”±ç‘å…¸MySQL AB å…¬å¸å¼€å‘ï¼Œå±äº Oracle æ——ä¸‹äº§å“ã€‚MySQL æ˜¯æœ€æµè¡Œçš„å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿå…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿä¹‹ä¸€ï¼Œåœ¨ WEB åº”ç”¨æ–¹é¢ï¼ŒMySQLæ˜¯æœ€å¥½çš„ RDBMS (Relational Database Management Systemï¼Œå…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ) åº”ç”¨è½¯ä»¶ä¹‹ä¸€

    é‡äº‹ä¸å†³è¿˜å¾—æ˜¯mysqlï¼Œä»¥åé‡æ„å¯ä»¥è€ƒè™‘mongodb

- [redis](https://redis.io/)

> ä¸€ä¸ªå¼€æºçš„ã€ä½¿ç”¨Cè¯­è¨€ç¼–å†™çš„ã€æ”¯æŒç½‘ç»œäº¤äº’çš„ã€å¯åŸºäºå†…å­˜ä¹Ÿå¯æŒä¹…åŒ–çš„Key-Valueæ•°æ®åº“

    ç¼“å­˜å­˜å‚¨è¿˜æ˜¯é€‰å‹æœ€æ™®éçš„redis

- [sentinel](https://sentinelguard.io/zh-cn/)

> ä¸€ä¸ªé¢å‘åˆ†å¸ƒå¼ã€å¤šè¯­è¨€å¼‚æ„åŒ–æœåŠ¡æ¶æ„çš„æµé‡æ²»ç†ç»„ä»¶

```
æˆ‘ç”¨æ¥åšé™æµ
```

- [jaeger](https://www.jaegertracing.io/)

> ç”±Uberå¼€æºçš„åˆ†å¸ƒå¼è¿½è¸ªç³»ç»Ÿ

```
æ—¥å¿—ç®¡ç†ä¹‹ä½™ï¼Œä½¿ç”¨jaegeråšè¿½è¸ªç³»ç»Ÿ
```

- [docker](https://www.docker.com/)

> Google å…¬å¸æ¨å‡ºçš„ Go è¯­è¨€ è¿›è¡Œå¼€å‘å®ç°ï¼ŒåŸºäº Linux å†…æ ¸çš„ cgroupï¼Œnamespaceï¼Œä»¥åŠ AUFS ç±»çš„ Union FS ç­‰æŠ€æœ¯çš„ä¸€ä¸ªå®¹å™¨æœåŠ¡

```
å®¹å™¨ç”¨docker-composeéƒ¨ç½²
```

## ğŸ“‚ å­˜å‚¨è®¾è®¡

### è¡¨è®¾è®¡

#### ç”¨æˆ·ç³»ç»Ÿ

##### `users`

##### æ¨¡æ‹Ÿç¬¬ä¸‰æ–¹ç”¨æˆ·è´¦å·

![](./images/image-20230530171635238.png)

![image-20230530171919804](./images/image-20230530171919804.png)

##### `user_bases`

èŠå¤©å®¤é¡¹ç›®æ‰€ç”¨ç”¨æˆ·è´¦å·æ•°æ®åº“

ç¬¬ä¸‰æ–¹ç™»å½•ç»‘å®šåå°†åœ¨æ­¤æ•°æ®åº“ä¸­æ·»åŠ æ•°æ®

![image-20230530172157094](./images/image-20230530172157094.png)

![image-20230530172053843](./images/image-20230530172053843.png)

`user_auths`

ç¬¬ä¸‰æ–¹ç”¨æˆ·ä¸èŠå¤©å®¤ç”¨æˆ·ç»‘å®š

![image-20230530172239074](./images/image-20230530172239074.png)

![image-20230530172313806](./images/image-20230530172313806.png)

#### èŠå¤©ç³»ç»Ÿ

##### `friend`

![image-20230530172413540](./images/image-20230530172413540.png)

![image-20230530172427961](./images/image-20230530172427961.png)



##### `groups`

![image-20230530172454833](./images/image-20230530172454833.png)

![image-20230530172508923](./images/image-20230530172508923.png)



##### `group_members`

![image-20230530172538903](./images/image-20230530172538903.png)

![image-20230530172548966](./images/image-20230530172548966.png)







##### `message`

![image-20230530172708114](./images/image-20230530172708114.png)

![image-20230530172732979](./images/image-20230530172732979.png)

### ç¼“å­˜è®¾è®¡

#### è¡¨ç¼“å­˜

#### ç”¨æˆ·ä¿¡æ¯ç¼“å­˜

ä½¿ç”¨å“ˆå¸Œè¡¨å­˜å‚¨å·²ç»æ³¨å†Œçš„ç”¨æˆ·ä¿¡æ¯

key åç§°ï¼š`user:[username]`

![image-20230530173836184](./images/image-20230530173836184.png)

#### ç”¨æˆ·è´¦å·idç¼“å­˜

ä½¿ç”¨ æœ‰åºé›†åˆ å­˜å‚¨ç”¨æˆ· id ä¸ç”¨æˆ·åï¼ˆQQé‚®ç®±ï¼‰ï¼Œæ–¹ä¾¿é€šè¿‡ å”¯ä¸€id è·å–ç”¨æˆ·å

key æ ¼å¼ï¼š`userID`

#### ![image-20230530173956438](./images/image-20230530173956438.png)

#### ç¬¬ä¸‰æ–¹è´¦å·ç»‘å®šç¼“å­˜

key æ ¼å¼ï¼š`Oauth2User`

![image-20230530174354581](./images/image-20230530174354581.png)

#### æ¶ˆæ¯ç¼“å­˜

å¥½å‹æ¶ˆæ¯ key æ ¼å¼ï¼š`friend:[id1]to[id2]`

![image-20230530174504096](./images/image-20230530174504096.png)

ç¾¤ç»„æ¶ˆæ¯ key æ ¼å¼: `group:[group_id]`



![image-20230530174558672](./images/image-20230530174558672.png)

ç¦»çº¿æ¶ˆæ¯ç¼“å­˜ï¼Œåœ¨è¢«è·å–ä¹‹åè‡ªåŠ¨åˆ é™¤

key æ ¼å¼: `id`

![image-20230530174644328](./images/image-20230530174644328.png)

#### é‚®ç®±éªŒè¯ç ç¼“å­˜

key æ ¼å¼ï¼š`mail:[username]`,120såè¿‡æœŸåˆ é™¤

![image-20230530174759479](./images/image-20230530174759479.png)

## ğŸ“– APIæ–‡æ¡£

[æ¥å£æ–‡æ¡£](https://console-docs.apipost.cn/preview/56cc7639487d33cb/20154c443f1b0168)

## ğŸ‘ï¸å¯è§‚æµ‹æ€§

æ—¥å¿—è®°å½•

![image-20230530180305078](./images/image-20230530180305078.png)

jaeger é“¾è·¯è¿½è¸ªï¼Œå¯ä»¥æ›´ä¾¿æ·åœ°è¿›è¡Œdebug

![image-20230530180353380](./images/image-20230530180353380.png)

![image-20230530180414994](./images/image-20230530180414994.png)



